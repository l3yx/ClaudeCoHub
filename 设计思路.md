我们团队内部目前大量使用claude code + skills 做AI工具，比如做代码审计，做工单review。
但存在几个问题，比如大家是各自做自己的工具，skills 等并没有在团队内统一沉淀和共享，像代码审计这种的话本质是一个skills+MCP工具，但是目前是在服务器上跑claude ，封装为http接口给其他人用。然后有些人有自定义的需求，会先跑代码审计，然后把审计报告再跑一遍自己的skills。
我现在想让大家统一集中放skills，也有个统一平台，不仅可以调用claude code完成任务，也可以配置定时任务，事件触发任务， claude code 完成任务还可以通过社交app给用户发消息，用户可以回到claude code会话对结果接着处理。
我之前的方案是计划使用claude code sdk，自己去构建web平台，实现聊天，会话管理，任务管理等功能。 实现统一的skills管理等。

但现在我有新的想法，首先claude code的配置作用域有这两种：User（~/.claude/ 目录	），Project（存储库中的 .claude/）。 我想的方案就是用一台服务器安装claude code， User配置作为我们整个团队的全局配置，里面放团队共用的规则，skills等， Project配置作为每个人的工作目录和个性化配置，然后通过ttyd 让团队每个成员可以独立启动一个或多个claude code进程进行工作
然后 ~/.claude/ 目录和 ~/workdir/xxxx/.claude/ 目录都需要先发布到git平台，本地文件自动从git拉取，
每个用户打开网站都会以他的工号自动登录，然后自动创建 ~/workdir/xxxx 的目录，这个成员的所有会话都在这个目录，他的个性话配置在 ~/workdir/xxxx/.claude/ ，相当于我放弃之前把这个项目当作代码仓库或者Project，而是用户工作目录
然后每个用户也可以配置周期任务，周期任务就是由web平台调度，在工作目录起一个claude code直接运行自然语言的任务，以-p模式运行


每个人在网站里，可以管理多个会话，比如创建一个会话，后端就是创建一个tmux session，运行claude code。 会话id要自己定义，用uuid，tmux会话和claude code 都指定为一样的id
关闭网页，后端会话持续运行着，用户打开网页可以看到之前的会话，继续使用。 也可以在网页里直接关闭会话，后端tmux session也关闭。 所以tmux 和 claude code 进程本身的状态就是会话的两种状态 alive / dead
但是 claude code 会话也有其他状态，比如正在前台任务执行，后台任务执行，完全空闲等待指令，但我们只用两种状态描述  idle 和 working，前台任务和后台任务都算working，完全空闲才算idle， 这个状态要读取claude命令行运行的最后几行数据才能判断
claude code 运行的会话本来就会存储在~/.claude/projects/xxx/[session-id].jsonl , 所以后端获取xxx用户有哪些会话就是要读取有哪些uuid，然后判断是否  alive / dead，就是看这个uuid的tmux session存不存在，如果alive状态下继续判断是idle还是working 就要读取tmux session里claude code的输出，判断最后几行的状态信息。（最后两行有‘esc to interrupt’ 或者 'running' 表示working，其他表示idle）
不要写单独的数据库或者数据存醋来存会话列表和状态等，这些都依靠Claude code 的配置或者日志文件，依靠以会话id命名的tmux session。
alive 的会话，如果用户选中，就是用xterm展示tmux中的内容，dead的会话就需要使用会话id，重新启动tmux运行claude --resume [session-id] 来恢复会话. 同样这个进程存活就是alive，这个进程如果结束就是dead
后端使用Python 、FastAPI 、ptyprocess, 前端使用 xterm.js、WebSocket

现在我要本地开发，有几个设计暂时这样：
1. 身份认证不用自动工号认证，而是改成账号密码登录，代码了写死账号密码两字符串一致就可以登录成功，后续我自己改
2. 暂时不管git同步机制，先把本地文件系统当作唯一数据源，后续我自己改
3. 周期任务其实就是设置一个定时+自然语言描述的任务，后面以claude code -p模式运行
4. 通过社交app给用户发消息等功能不需要在平台实现，后续我添加mcp或者skills就行
5. 不用ttyd开发，ttyd只适合测试用，不能集成到我的系统
6. 周期任务的配置还是需要持续化的，但不用数据库，用~/workdir/xxxx/下面创建 .claudecohub 目录，然后里面放schedules.yaml
7. 所有用户的claud code 都走同一个llm api，默认在~/.claude/settings.json 配置好